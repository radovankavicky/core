% Copyright (c) 2013, authors of "Core Econometrics;" a
% complete list of authors is available in the file AUTHORS.tex.

% Permission is granted to copy, distribute and/or modify this
% document under the terms of the GNU Free Documentation License,
% Version 1.3 or any later version published by the Free Software
% Foundation; with no Invariant Sections, no Front-Cover Texts, and no
% Back-Cover Texts.  A copy of the license is included in the file
% LICENSE.tex and is also available online at
% <http://www.gnu.org/copyleft/fdl.html>.

\chapter{Multiple hypothesis testing in linear regression}

\section{Testing multiple hypotheses}

Some special issues come up when we have many hypotheses.  I need to
figure out some simulations to motivate this stuff.

\subsection{Intersection-Union Test}

\begin{itemize}
\item Suppose the null can be written as an intersection of simpler
  nulls:
  \begin{itemize}
  \item $H_0: \theta \in \bigcup_{\gamma \in \Gamma} \theta_\gamma$ vs.  $H_A: \theta \notin \bigcap_{\gamma \in \Gamma} \theta_\gamma$
  \item It is easy to find tests for each individual set:
    \begin{itemize}
    \item $T_\gamma$ tests the null $\theta \in \theta_\gamma$ vs. $\theta \notin \theta_\gamma$ for each $\gamma$.
    \end{itemize}
  \item If $T_\gamma$ is a level-$\alpha$ test with rejection region $R_\gamma$ (ie
    it rejects if $(x_1,\dots,x_n) \in R$), then the test with rejection
    region $\bigcap_{\gamma \in \Gamma} R_\gamma$ is the IU Test and has level $\alpha$
  \end{itemize}
\item Note that we don't need to correct the critical values here
\end{itemize}

\paragraph{Proof of validity}
\begin{itemize}
\item We know that, under the null, $\theta \in \theta_\gamma'$ for at least one $\gamma'$
\item $\Pr_\theta[(X_1,\dots,X_n) \in \bigcap_\gamma R_\gamma] \leq \Pr_\theta[(X_1,\dots, X_n) \in R_{\gamma'}] \leq \alpha$
\end{itemize}

\subsection{Union-Intersection Test}

\paragraph{Setup of UIT}
\begin{itemize}
\item Suppose the null can be written as an intersection of simpler
  nulls:
  \begin{itemize}
  \item $H_0: \theta \in \bigcap_{\gamma \in \Gamma} \theta_\gamma$ vs.  $H_A: \theta \notin \bigcap_{\gamma \in \Gamma} \theta_\gamma$
  \item It is easy to find tests for each individual set:
    \begin{itemize}
    \item $T_\gamma$ tests the null $\theta \in \theta_\gamma$ vs. $\theta \notin \theta_\gamma$ for each $\gamma$.
    \end{itemize}
  \item If $T_\gamma$ is a level-$\frac{\alpha}{\# \Gamma}$ test with rejection
    region $R_\gamma$ (ie it rejects if $(x_1,\dots,x_n) \in R$), then the test
    with rejection region $\bigcup_{\gamma \in \Gamma} R_\gamma$ is the UI Test and has level
    $\alpha$
  \end{itemize}
\item Note that we don't need to use a stepdown procedure here
\item Could still do better if we used the joint distribution of $T_\gamma$
\end{itemize}

\paragraph{Show that testing at $\alpha$ doesn't work}

\paragraph{Proof of validity}
\begin{itemize}
\item Follows from the same argument as in multiple comparisons
  \begin{align*}
    \Pr_\theta[(X_1,\dots,X_n) \in \bigcup_{\gamma} R_\gamma] 
    &\leq \sum_{\gamma \in \Gamma} \Pr_\theta[(X_1,\dots,X_n) \in R_\gamma] \\
    &\leq \sum_\gamma \frac{\alpha}{\#\Gamma} \\
    &= \alpha
  \end{align*}
\end{itemize}

\subsection{Multiple hypothesis testing}

\begin{itemize}
\item Suppose we have a bunch of hypotheses $\theta \in \theta_\gamma$, but instead of
  being interested in knowing about compound hypotheses, we're
  interested in all of them
  \begin{itemize}
  \item have many different parameters
  \item Put up empirical example where we're looking at regressors
  \end{itemize}
\item Now we want to control the rate of ``familywise error''
  \begin{itemize}
  \item Let $I$ index the true nulls: $I = \{\gamma \in \Gamma : \theta_\gamma \in \theta_\gamma\}$
  \item FWE is \[\sup_{\theta: \theta_\gamma \in \theta_\gamma, \gamma \in I} \Pr_\theta[T_\gamma \text{ rejects
      for at least one } \gamma \in I]\]
  \item want this error probability to be less than $\alpha$
  \end{itemize}
\item As with UIT, testing each one at $\alpha$ doesn't work
  \begin{itemize}
  \item show this
  \end{itemize}
\end{itemize}

\paragraph{Bonferroni bound}

\paragraph{Bonferroni-Holm stepdown}

\paragraph{Critical values from the joint distribution}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../core_econometrics"
%%% End:
