% Copyright © 2013, authors of "Core Econometrics Notes;" a
% complete list of authors is available in the file AUTHORS.tex.

% Permission is granted to copy, distribute and/or modify this
% document under the terms of the GNU Free Documentation License,
% Version 1.3 or any later version published by the Free Software
% Foundation; with no Invariant Sections, no Front-Cover Texts, and no
% Back-Cover Texts.  A copy of the license is included in the file
% LICENSE.tex and is also available online at
% <http://www.gnu.org/copyleft/fdl.html>.

\part*{Heteroskedasticity in finite samples}%
\addcontentsline{toc}{part}{Heteroskedasticity in finite samples}

\section{Generalized Least Squares}

Reading is \citet[8.3]{Gre12}

\subsection{motivation}

\begin{itemize}
\item Suppose that instead of having $\E( ε ε' ∣ X) = σ² I$ we knew
  that $\E(ε ε ∣ X) = σ² Ω$ for some other known matrix $Ω$.
\item we could still do MLE to estimate $β$ and $σ$
\item Would generally give you a different estimate of $β$ than OLS.
\end{itemize}n

\subsection{Infeasible GLS}

\paragraph{Draw pictures}

\paragraph{mathematics}
\begin{itemize}
\item We know that $Ω^{-1/2}ε ∼ (0, σ² I)$ given $X$
\item What happens if we regress $Ω^{-1/2} Y$ on $Ω^{-1/2} X$?
\begin{itemize}
\item Let $\Yt = Ω^{-1/2} Y$
\item Let $\Xt = Ω^{-1/2} X$
\item $\εt = \Yt - \Xt β$
\end{itemize}
\item If $\E(Y ∣ X) = Xβ$ then $\E(\Yt ∣ X) = \Xt β$
\item If we regress $\Yt$ on $\Xt$, we're back in standard
        OLS with homoskedastic errors.
\item Estimator is $\βh_{GLS} = (X'Ω^{-1}X)^{-1}X'Ω^{-1}Y$
\begin{itemize}
\item Unbiased (obviously)
\item Satisfies Gauss-Markov (BLUE)
\item Variance is $σ² (\Xt' \Xt)^{-1} = σ² (X' Ω^{-1} X)^{-1}$
\item Normal if the error terms are normal
\item Asymptotically normal otherwise.
\end{itemize}
\end{itemize}

\subsection{Weighted Least Squares (ie example)}

\begin{itemize}
\item Suppose that we believe that $σ²_i = σ² x_{ij}²$ for one of the
  regressors $j$.
\begin{itemize}
\item textbook gives an example: dependent variable is firm profits
         and indep variable is size.
\end{itemize}
\item To implement GLS, we want to regress
  \[ y/x_k = β + β₁(x₁/x_k) + β₂(x₂/x_k) + ⋯ + ε/x_k \]
\begin{itemize}
\item intuitively, if the firm is bigger, profit is more volatile
         and so we want to count that observation less in our estimation.
\end{itemize}
\end{itemize}

\subsection{Feasible GLS}

\begin{itemize}
\item Suppose that $Ω$ has a few unknown parameters:
\begin{itemize}
\item Two examples from TS:
\begin{itemize}
\item $Ω = (1, ρ, ρ², ...)$ (as a matrix)
\item $Ω = (1, γ, 0, 0; γ, 1, ...)$ (as a matrix)
\end{itemize}
\end{itemize}
\item We could just estimate those parameters along with the others.
\item Two different approaches
\begin{itemize}
\item MLE (next semester)
\item two-step least squares (FGLS)
\end{itemize}
\end{itemize}

\paragraph{Explanation of approach}
\begin{itemize}
\item Remember how we tested for heteroskedasticity
\item regress $\εh$ on the (squared) regressors and test
        for significance
\item use a similar approach here, but use for modeling.
\item Suppose that
        \[ \E(ε²_i ∣ X) = z_i'α \]
        where $z_i$ is some function of the regressors.
\item If we could regress $ε²_i$ on $z_i$, we could estimate $α$ consistently.
\item Since $\εh_i$ is consistent for $ε_i$, we can regress $ε²_i$ on
  $z_i$ to estimate $α$.
\end{itemize}

\paragraph{Algorithm}
\begin{itemize}
\item Regress $y$ on $x$ to get $\εh$
\item Regress $\εh$ on $z$ to estimate $α$
\item Regress $y_i/w_i$ on $x_i/w_i$ to estimate $\βh_{FGLS}$ where
  $w_i = sqrt{z_i'\αh}$
\end{itemize}

\paragraph{some more math}
\begin{itemize}
\item if we let $\Ωh$ be the estimate of $Ω$ that uses $\αh$,
  consistency of $\αh$ ensures that $\Ωh$ behaves asymptotically like
  $Ω$.
\item All of the asymptotic results from the GLS estimator apply to
        the Feasible GLS estimator
\item Finite sample results don't necessarily hold.
\end{itemize}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../regression"
%%% End:
