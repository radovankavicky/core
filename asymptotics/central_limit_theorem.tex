% Copyright © 2013, authors of the "Econometrics Core" textbook; a
% complete list of authors is available in the file AUTHORS.tex.

% Permission is granted to copy, distribute and/or modify this
% document under the terms of the GNU Free Documentation License,
% Version 1.3 or any later version published by the Free Software
% Foundation; with no Invariant Sections, no Front-Cover Texts, and no
% Back-Cover Texts.  A copy of the license is included in the file
% LICENSE.tex and is also available online at
% <http://www.gnu.org/copyleft/fdl.html>.

\part*{Central Limit Theorem}%
\addcontentsline{toc}{part}{Central Limit Theorem}

\section{Introduction}

    We've been talking about convergence to random variables or
    constants.  Sometimes that's too limiting a concept: we often have
    cases where there's not a particular \emph{variable} that our sequence
    converges to, but instead its behavior gets closer and closer to
    that of another random variable.  

\subsection{example}

     Let $X_n =$ 0 with probability $1/2 + 1/n$ and 1 with probability
     $1/2 - 1/n$.  Let $Y_n = - 1$ or 2 with probability $1/2n$ each and
     0 or 1 with probability $(1-n)/2$ each.  Also let $X_n$ and $Y_n$
     be independent of each other.
\begin{itemize}
\item Draw pictures
\item in a sense, we want $X_n$ and $Y_n$ to converge to each other --
       as $n$ increases, they behave increasingly like each other.
\item but, if we look at $X_n - Y_n$, the random variable is
\begin{itemize}
\item $-1$ with prob $(1/2 + 1/n)/2n$
\item 0 with prob $(1/2 + 1/n)(1 - n)/2 + (1/2-1/n)/2n$
\item 1 with prob $(1 - n)/2$
\item 2 with prob $(1/2 + 1/n)(1-n)/2 + (1/2+1/n)/2n$
\end{itemize}
\item and this random variable clearly does not converge to zero in any
       sense.
\end{itemize}

\subsection{discussion}

\begin{itemize}
\item This example is (obviously) contrived, but as you know, there are
       many situations where we have a random sequence like $Y_n$ that
       has a distribution that is either unknown or difficult to work
       with, and another sequence $X_n$ that is known and easy to work
       with.
\item We'd like to be able to say that the sequences ``converge'' somehow
       and use the easier sequence in our application.
\item motivates convergence in distribution
\end{itemize}

\section{convergence in distribution}

    We're going to talk about ``distributions'' here because (remember)
    they are guaranteed to exist while densities are not.

\subsection{definition}

     Let $\{X_n\}$ be a sequence of random variables with cdfs $F_n$.
     $X_n$ converges in distribution to a random variable $X$ with cdf
     $F(·)$ if 
     \[ \lim_{n → ∞} \lvert F_n(c) - F(c) \rvert = 0 \]
     for all continuitiy points $c$ of $F(·)$.

\subsection{Discussion}

\begin{itemize}
\item Discuss point of continuity with a picture.
\item written (usually) $X_n →^d F$ or $X_n →^d X$.
\item A few useful results \citep[D.16]{Gre12}
\begin{enumerate}
\item If $X_n →^d X$ and $Y_n →^p c$ (a constant) then
  $X_n Y_n →^d c X$ and $X_n + Y_n →^d X + c$
\item If $X_n →^d X$ and $g(·)$ is a continuous function, then
  $g(X_n) →^d g(X)$
\item If $Y_n →^d Y$ and $X_n - Y_n →^p 0$ then $X_n →^d Y$.
\begin{itemize}
\item give intuitive proof.
\end{itemize}
\end{enumerate}
\item for convergence to a constant only: If $Y_n →^d c$ for $c$ a
  constant, then $Y_n →^p c$.
\item how does one prove convergence in distribution?
\begin{itemize}
\item don't usually sit down with the distribution functions.
\item remember for convergence in probability -- when you can, use
         Chebychev's inequality to turn the statement about
         probabilities into a statement about expectations, and then
         prove convergence for the expectations.
\item there's a similar approach for densities/distributions (we
         don't have time to get into this in detail)
\begin{description}
\item[moment generating function] The moment generating function
  of a random vector $X$ is defined as $\E e^{t'X}$
\begin{itemize}
\item doesn't always exist.
\end{itemize}
\item[characteristic function] The characteristic function of a
  random vector $X$ is defined as $\E e^{it'X}$
\begin{itemize}
\item always exists
\item requires that you know some complex analysis.
\end{itemize}
\item[Useful fact] if two random variables have the same moment
                          generating function or characteristc function
                          then they have the same distribution
                          function.
\begin{itemize}
\item Add proof
\end{itemize}
\item[cramer-wold device] (one version of it) Let $X$ be a
             random $k$-vector.  $a'X$ is normally distributed for
             every deterministic $k$-vector $a$ iff $X$ is
             multivariate normal.
\begin{itemize}
\item have students prove for homework
\end{itemize}
\item[so] convergence in distribution (as in a central limit
                 theorem) is established by proving that the
                 characteristic function of the series you are
                 interested in converges to the characteristic fucntion
                 of the limiting distribution.
\end{description}
\end{itemize}
\end{itemize}

\section{Central limit theorem}

    The biggest application of convergence in distribution is the
    central limit theorem.  (I assume you're familiar).

\subsection{Overview}

\begin{itemize}
\item I'm not going to go through each specific CLT that greene
       presents (you are responsible for them).
\item We'll talk about the simplest case and then talk about how
       differences come into play.
\end{itemize}

\subsection{Lindberg-Levy Central Limit Theorem (want to leave up)}

If $X₁,...,X_n$ are iid $(μ, σ²)$ then \[\sqrt{n} (\Xb - μ) →^d N(0,σ²).\]

\begin{itemize}
\item illustrate with pictures what this means (distribution of
  $\Xb$), then blow it up.
\end{itemize}

\subsection{Lindberg-Feller CLT (a variation)}

     Suppose that $X₁,...,X_n$ are independent random variables with
     $X_i ∼ (μ_i, σ²_i)$ and $\μb = n^{-1}∑_{i=1}^n μ_i$ and
     $\bar{σ²} = n^{-1} ∑_{i=1}^n σ²_i$.  If $\bar{σ}²$ converges and if
     \[\lim_{n→∞} \max(σ²_i)/(n\sqrt{\bar{σ}²}) = 0\]
     then 
     \[\sqrt{n}(\Xb - \μb)/\sqrt{\bar{σ²}} →^d N(0,1)\]

\begin{itemize}
\item illustrate with pictures what this means
\item counter example for variance assumption:
\begin{itemize}
\item suppose that $σ²_i = 2^{-i}$.
\item $\bar{σ²} = n^{-1} ∑_{i=1}^n 2^{-i} = n^{-1}(1 - (1/2)^n)$
\item $\max(σ²_i)/(n\bar{σ}²) = 1/(1-0.5^n) → 1$.
\item problem in this example: the first few random variables are
         going to have a large influence on the average; compare to
         $σ²_i = 4$ if $i$ is even and 1 if $i$ is odd.
\end{itemize}
\end{itemize}

\subsection{multivariate Lindberg-Levy CLT}

If $X₁,...,X_n$ are iid random vectors with mean $μ$ and vcv $Σ$,
then \[\sqrt{n}(\Xb - μ) →^d N(0,Σ).\]
\begin{description}
\item[proof] Want to use the Cramer-Wold device.
\begin{description}
\item[statement] Let $X$ be a random $k$-vector.  If $a'X$
                  is normally distributed for every deterministic
                  $k$-vector $a$, then $X$ is multivariate normal.
\item[implication] if $a'(\sqrt{n}(\Xb - μ))$ is
                  asymptotically normal with mean zero and variance
                  $a'Σ a$ for any choice of $a$, then conclusion
                  holds.
\item[first] Let $a$ be an arbitrary vector of constants
                           with the same dimension as $X_i$.
\item[argument] consider the sequence $a'X₁,...,
                              a'X_n$.
\begin{itemize}
\item iid $(a'μ, a'Σ a)$
\item this sequence satisfies the Lindeberg-Levy CLT,
  so \[\sqrt{n}(a'\Xb - a'μ) →^d N(0,a'Σ a)\]
\item This holds for any choice of $a$, so we're done.
\end{itemize}
\end{description}
\end{description}

\subsection{remarks}

\begin{itemize}
\item this is used as an ``approximation''
\item remember that if each $X_i$ is normally distributed, this is the
       \emph{exact} distribution
\begin{itemize}
\item follows that if the $X_i$ s are close to the normal
         distribution, the approximation will be very accurate, and if
         they are far from the normal distribution the approximation
         will be poor.
\item features of the normal:
\begin{itemize}
\item symmetric
\item ``thin tails''
\end{itemize}
\end{itemize}
\item the ``independence'' assumption can be weakened.  We're really
       trying to rule out cases like this one:
\begin{itemize}
\item let $Z$ be bernoulli(1/2)
\item let $\ep_i$ be iid (0,1)
\item define $X_i = Z + \ep_i$ (and we only see the $X$ s).
\item Then the mean of $X_i$ is 1/2, the variance is $\var(Z + \ep_i)
  = 1/4 + 1 = 5/4$.
\item obviously, this does not converge to a normal r.v.
\begin{itemize}
\item plot graphs
\item if $Z = 0$ converges to normal at mean 0
\item if $Z = 1$ converges to normal at mean 1
\item converges to a mixture of normals
\end{itemize}
\item what's happening?
\begin{itemize}
\item suppose we see $X₁ = 4$.  Makes it extremely unlikely that
           $Z = 1$ (can calculate from Bayes rule).
\item so if we see $X_i = 4$, we know that different values of
           $X₂$ are likely.
\item more imporantly, we know that different values of $X_n$ are
           likely -- the density of $X_i$ depends on $X₁$, no matter
           how far apart in time they are.
\end{itemize}
\item caveat :: there's a sense that even this result should be
                   considered a ``central limit theorem'';
\end{itemize}
\end{itemize}

\section{delta method}
\subsection{introduction}

     Suppose we have have a sequence of random variables that obeys a
     central limit theorem (an estimator, for example).  We might want
     to know the distribution of functions of that r.v.  Our previous
     result is sometimes awkward if the function is awkward, so there's
     a simpler approximation we can usually use.
\begin{itemize}
\item draw picture (behavior of $\Xb$ and smooth function $g$).
\item two random sequences:
\begin{itemize}
\item $g(\Xb) - g(μ)$ and $g'(μ) (\Xb - μ)$
\item Taylor expansion suggests
         \[g(\Xb) = g(μ) + g'(μ) (\Xb - μ) + remainder\]
         so
         \[\sqrt{n} (g(\Xb) - g(μ)) = g'(μ) \sqrt{n} (\Xb - μ) + \sqrt{n} remainder\]
\item we know that $\sqrt{n} g'(μ) (\Xb - μ)$ is
         asymptotically normal.
\item suggests that $\sqrt{n}(g(\Xb) - g(μ))$ is asymptotically
         normal as well.
\end{itemize}
\end{itemize}

\subsection{statement (Casella and Berger)}

     Let $\{Y_n\}$ be a sequence of random variables that satisfies
     \[\sqrt{n}(Y_n - θ) →^d N(0,σ²).\]  
     Suppose that the function $g$ is differentiable at $θ$ and $g'(θ)
     ≠ 0$.  Then
     \[\sqrt{n}[g(Y_n) - g(θ)] →^d N(0, σ²[g'(θ)]²).\]
\begin{description}
\item[note] follows from a Taylor expansion of $g(Y_n)$ around
               $g(θ)$.  If $g'(θ)=0$, you can get a
               distributional result by taking a second order expansion.
\end{description}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../../asymptotics"
%%% End: 
